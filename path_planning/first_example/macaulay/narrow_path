R = QQ[x_1, x_2]

p = (x_1 - 1)^2 + x_2^2 - 1/4

M = image diff(matrix{{x_1, x_2}}, p)
J = quotient(M, p)
G = gens gb J
G0 = gens gb ideal M
L = (G0 * transpose(G0))_(0, 0)

st = diff(matrix{{x_1, x_2}}, p) | matrix{{L * p}}
gf = syz st
h = gf_{0}^{0, 1}

f = 1 / substitute(gf_(2, 1), QQ) * (gf_{1}^{0, 1})
M = h | matrix{{p, 0}, {0, p}} | f
R = syz M

Y = R_(0, 0)
y = substitute(1 / R_(3, 1), QQ) * R_(0, 1)
f0 = f + h * y
